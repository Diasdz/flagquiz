<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ultimate Flag Quiz</title>
  <style>
    /* STYLES INCHANG√âS (d√©j√† pr√©sents dans la version pr√©c√©dente) */
    /* ... contenu CSS identique ... */
  </style>
</head>
<body>
  <button class="dark-mode-toggle" onclick="toggleDarkMode()">üåì</button>
  <img src="https://raw.githubusercontent.com/Diasdz/flagquiz/refs/heads/main/Ultimate%20Flag%20Quiz.svg" alt="Ultimate Flag Quiz" class="title-logo">

  <div class="start-screen" id="startScreen">
    <h2>Do you know all 195 world flags?</h2>
    <p>Choose your game mode:</p>
    <button class="btn" onclick="startClassicMode()">Classic Mode</button>
    <button class="btn btn-secondary" onclick="showDifficultyOptions()">Challenge Mode ‚è±Ô∏è</button>
    <button class="btn" onclick="showContinentSelection()">Continent Mode üåç</button>
  </div>

  <div class="continent-selection" id="continentSelection" style="display:none">
    <h2>Choose a continent</h2>
    <button class="continent-btn" onclick="startContinentMode('europe')">Europe</button>
    <button class="continent-btn" onclick="startContinentMode('africa')">Africa</button>
    <button class="continent-btn" onclick="startContinentMode('asia')">Asia</button>
    <button class="continent-btn" onclick="startContinentMode('america')">America</button>
    <button class="continent-btn" onclick="startContinentMode('oceania')">Oceania</button>
    <button class="continent-btn" onclick="startContinentMode('all')">All countries</button>
    <button class="btn-secondary" onclick="showStartScreen()">Back</button>
  </div>

  <div id="difficultyOptions" style="display:none">
    <h3>Choose difficulty:</h3>
    <button class="btn difficulty-btn easy" onclick="setDifficulty('easy')">Easy (10s)</button>
    <button class="btn difficulty-btn medium" onclick="setDifficulty('medium')">Medium (8s)</button>
    <button class="btn difficulty-btn hard" onclick="setDifficulty('hard')">Hard (5s)</button>
    <button class="btn" onclick="startChallengeMode()">Start Challenge</button>
    <button class="btn-secondary" onclick="showStartScreen()">Back</button>
  </div>

  <div class="quiz-card" id="quizContainer" style="display:none"></div>
  <div class="result-card" id="result" style="display:none"></div>

  <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
  <audio id="wrongSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
  <audio id="timeoutSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-explosion-2759.mp3"></audio>

  <script>
    const countries = [
      ["Germany", "https://flagcdn.com/w320/de.png"],
      ["France", "https://flagcdn.com/w320/fr.png"],
      ["Italy", "https://flagcdn.com/w320/it.png"],
      ["Spain", "https://flagcdn.com/w320/es.png"],
      ["Brazil", "https://flagcdn.com/w320/br.png"] // add more as needed
    ];

    let score = 0;
    let currentQuestion = 0;
    let questions = [];

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
    }

    function showStartScreen() {
      document.getElementById("startScreen").style.display = "block";
      document.getElementById("continentSelection").style.display = "none";
      document.getElementById("difficultyOptions").style.display = "none";
      document.getElementById("quizContainer").style.display = "none";
      document.getElementById("result").style.display = "none";
    }

    function showContinentSelection() {
      document.getElementById("startScreen").style.display = "none";
      document.getElementById("continentSelection").style.display = "block";
    }

    function showDifficultyOptions() {
      document.getElementById("startScreen").style.display = "none";
      document.getElementById("difficultyOptions").style.display = "block";
    }

    function setDifficulty(level) {
      // Could be extended for timing logic
      console.log("Difficulty set to:", level);
    }

    function startClassicMode() {
      startQuiz();
    }

    function startChallengeMode() {
      startQuiz();
    }

    function startContinentMode(mode) {
      // For now all same
      startQuiz();
    }

    function startQuiz() {
      questions = generateQuestions();
      currentQuestion = 0;
      score = 0;
      document.getElementById("startScreen").style.display = "none";
      document.getElementById("quizContainer").style.display = "block";
      showQuestion();
    }

    function generateQuestions() {
      const shuffled = countries.sort(() => 0.5 - Math.random());
      return shuffled.map(([name, flag]) => {
        const options = countries.filter(c => c[0] !== name).sort(() => 0.5 - Math.random()).slice(0, 3);
        options.push([name, flag]);
        return {
          flag,
          correct: name,
          choices: options.sort(() => 0.5 - Math.random()).map(c => c[0])
        };
      });
    }

    function showQuestion() {
      const q = questions[currentQuestion];
      const container = document.getElementById("quizContainer");
      container.innerHTML = `
        <img src="${q.flag}" alt="Flag" class="flag-image">
        <div class="choices">
          ${q.choices.map((choice, i) => `<label><input type="radio" name="choice" value="${choice}" onchange="selectAnswer('${choice}')"> ${choice}</label>`).join("")}
        </div>
        <button class="btn" onclick="nextQuestion()">Next</button>
      `;
    }

    function selectAnswer(choice) {
      const q = questions[currentQuestion];
      const labels = document.querySelectorAll(".choices label");
      labels.forEach(label => {
        const input = label.querySelector("input");
        input.disabled = true;
        if (label.textContent.trim() === q.correct) {
          label.classList.add("correct");
        } else if (label.textContent.trim() === choice) {
          label.classList.add("incorrect");
        }
      });
      if (choice === q.correct) {
        score++;
        document.getElementById("correctSound").play();
      } else {
        document.getElementById("wrongSound").play();
      }
    }

    function nextQuestion() {
      currentQuestion++;
      if (currentQuestion < questions.length) {
        showQuestion();
      } else {
        showResult();
      }
    }

    function showResult() {
      const container = document.getElementById("result");
      container.style.display = "block";
      document.getElementById("quizContainer").style.display = "none";
      const percentage = Math.round((score / questions.length) * 100);
      let comment = "";
      if (percentage >= 90) comment = "üåü Excellent! You're a true flag expert!";
      else if (percentage >= 70) comment = "üëç Very good! You know your flags well!";
      else if (percentage >= 50) comment = "ü§î Not bad! A little more practice and you'll be on top!";
      else comment = "üìö Keep learning, you'll improve!";

      container.innerHTML = `
        <h2>Quiz Completed!</h2>
        <p>Your Score: <strong>${score} / ${questions.length}</strong></p>
        <p>Success Rate: <strong>${percentage}%</strong></p>
        <p style="font-style: italic;">${comment}</p>
        <button class="btn" onclick="startQuiz()">Play Again</button>
        <button class="btn-secondary" onclick="showStartScreen()">Main Menu</button>
      `;
    }
  </script>
</body>
</html>
